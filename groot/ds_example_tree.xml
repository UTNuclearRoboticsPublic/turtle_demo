<?xml version="1.0" encoding="UTF-8"?>
<root BTCPP_format="4">
  <BehaviorTree ID="Get Parts">
    <Fallback name="Get Parts">
      <Sequence>
        <HumanPresent/>
        <RequestParts/>
        <WaitForParts/>
      </Sequence>
      <Sequence>
        <Fallback>
          <FullBattery/>
          <RechargeBattery/>
        </Fallback>
        <GoToStorage/>
      </Sequence>
    </Fallback>
  </BehaviorTree>

  <BehaviorTree ID="Get Parts Complex">
    <Fallback name="Get Parts">
      <Sequence>
        <Fallback>
          <ResupplySoon/>
          <Sequence>
            <HumanPresent/>
            <Fallback>
              <HumanOnSchedule/>
              <HighTraffic/>
            </Fallback>
            <RequestParts/>
          </Sequence>
        </Fallback>
        <WaitForParts/>
      </Sequence>
      <Sequence>
        <Fallback>
          <FullBattery/>
          <RechargeBattery/>
        </Fallback>
        <GoToStorage/>
      </Sequence>
    </Fallback>
  </BehaviorTree>

  <BehaviorTree ID="Get Parts DS">
    <ReactiveSequence name="Get Parts">
      <InputDataNode data="{data}"/>
      <DynamicSelector data="{data}">
        <Sequence name="Request Parts">
          <HumanPresent/>
          <RequestParts/>
          <WaitForParts/>
        </Sequence>
        <Sequence name="Recharge Battery">
          <RechargeBattery/>
          <WaitForParts/>
        </Sequence>
        <Sequence name="Go To Storage">
          <RechargeBattery/>
          <GoToStorage/>
        </Sequence>
      </DynamicSelector>
    </ReactiveSequence>
  </BehaviorTree>

  <BehaviorTree ID="Main Tree">
    <Repeat num_cycles="-1">
      <Sequence>
        <Fallback>
          <HasParts/>
          <SubTree ID="Get Parts"/>
        </Fallback>
        <AttachPart/>
      </Sequence>
    </Repeat>
  </BehaviorTree>

  <!-- Description of Node Models (used by Groot) -->
  <TreeNodesModel>
    <Action ID="AttachPart"
            editable="true"/>
    <Control ID="DynamicSelector"
             editable="true">
      <input_port name="data"/>
    </Control>
    <Condition ID="FullBattery"
               editable="true"/>
    <Action ID="GoToStorage"
            editable="true"/>
    <Condition ID="HasParts"
               editable="true"/>
    <Condition ID="HighTraffic"
               editable="true"/>
    <Condition ID="HumanOnSchedule"
               editable="true"/>
    <Condition ID="HumanPresent"
               editable="true"/>
    <Action ID="InputDataNode"
            editable="true">
      <output_port name="data"/>
    </Action>
    <Action ID="RechargeBattery"
            editable="true"/>
    <Action ID="RequestParts"
            editable="true"/>
    <Condition ID="ResupplySoon"
               editable="true"/>
    <Action ID="WaitForParts"
            editable="true"/>
  </TreeNodesModel>

</root>
